# 后端-数据库-CLICKHOUSE


## 基础
1. ClickHouse有非常优异的查询性能，非常适合海量数据在线查询分析场景。

### 查询优势
1. 行式数据库查询一列的数据，`查询的时候也必须把其他的数据顺便查出来，所以会有磁盘IO的性能问题`。
2. 列式数据库只需要把这一列查询出来就行了，其他的没有关系的不关心，瞬间就减少了数据量呀，这个优点尤其是在`海量数据`的时候尤其明显，查询速度秒杀行式数据库。
3. mysql在做查询优化的时候，最常用的手段就是建立索引，可是我们想一想，数据量一旦大的时候，索引也会成倍的增长。
4. 列式数据库则不然，他的每一列就是索引，减少了额外建立索引的内容。
5. 【缺点】查询全列数据。

### 压缩优势【磁盘IO】
1. 列式数据库按照一列列来存贮，每一列的数据的相同性极高，这就为压缩埋下了很好的种子，`压缩比可以达到很大`，可以达到5～20倍以上。

### 使用场景
1. 行式数据库主要应用于传统的业务场景中
2. 列式数据库则应该发挥他查询速度方面的优势，主要用于`海量数据分析`一类的方面。
3. 数据分析场景特点：
```
1. 读多于写:数据一次性写入后，分析师需要尝试从各个角度对数据做挖掘、分析，直到发现其中的商业价值、业务变化趋势等信息。
2. 大宽表(列数高达数百甚至数千列)，读大量行但是少量列，结果集较小.
3. 数据批量写入(存档)，且数据不更新或少更新.
4. 无需事务，数据一致性要求低。（对于事务需求较少，通常是导入历史日志数据，或搭配一款事务型数据库并实时从事务型数据库中进行数据同步。多数OLAP系统都支持最终一致性。）
5. 灵活多变，不适合预先建模。
```

### clickhouse特点
1. ClickHouse支持在建表时，指定将数据按照某些列进行sort by。
2. 主键索引。ClickHouse支持主键索引，它将每列数据按照index granularity（默认8192行）进行划分，每个index granularity的开头第一行被称为一个mark行。主键索引存储该mark行对应的primary key的值。
3. ClickHouse支持对任意列创建任意数量的稀疏索引。其中被索引的value可以是任意的合法SQL Expression，并不仅仅局限于对column value本身进行索引。之所以叫稀疏索引，是因为它本质上是对一个完整index granularity（默认8192行）的统计信息，并不会具体记录每一行在文件中的位置。
4. 数据Sharding
5. 数据Partitioning
6. 数据TTL
7. 高吞吐写入能力
8. 有限支持delete、update
9. 主备同步
10. ClickHouse计算层
11. 多核并行
12. 分布式计算
13. 向量化执行与SIMD
14. 动态代码生成Runtime Codegen
15. 近似计算
16. 复杂数据类型支持



